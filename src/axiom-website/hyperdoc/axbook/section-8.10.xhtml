<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
"http://www.w3.org/TR/MathML2/dtd/xhtml-math11-f.dtd" [
<!ENTITY mathml "http://www.w3.org/1998/Math/MathML">
]>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xlink="http://www.w3.org/1999/xlink" >


  <head>
    <title>Section8.10</title>
    <link rel="stylesheet" type="text/css" href="graphicstyle.css" />
    <script type="text/javascript" src="bookax1.js" />
  </head>

  <body>
<a href="book-contents.xhtml" style="margin-right: 10px;">Book Contents</a><a href="section-8.9.xhtml" style="margin-right: 10px;">Previous Section 8.9 Working with Power Series</a><a href="section-8.11.xhtml" style="margin-right: 10px;">Next Section 8.11 Finite Fields</a>
<a href="book-index.xhtml">Book Index</a><div class="section"  id="sec-8.10">
<h2 class="sectiontitle">8.10  Solution of Differential Equations</h2>


<a name="ugProblemDEQ" class="label"/>


<p>In this section we discuss Axiom's facilities for
<span class="index">equation:differential:solving</span><a name="chapter-8-150"/> solving <span class="index">differential
equation</span><a name="chapter-8-151"/> differential equations in closed-form and in series.
</p>


<p>Axiom provides facilities for closed-form solution of
<span class="index">equation:differential:solving in closed-form</span><a name="chapter-8-152"/> single
differential equations of the following kinds:
</p>



<ul>
<li>
 linear ordinary differential equations, and
</li>
<li> non-linear first order ordinary differential equations
when integrating factors can be found just by integration.
</li>
</ul>



<p>For a discussion of the solution of systems of linear and polynomial
equations, see <a href="section-8.5.xhtml#ugProblemLinPolEqn" class="ref" >ugProblemLinPolEqn</a> .
</p>



<a name="subsec-8.10.1"/>
<div class="subsection"  id="subsec-8.10.1">
<h3 class="subsectitle">8.10.1  Closed-Form Solutions of Linear Differential Equations</h3>


<a name="ugxProblemLDEQClosed" class="label"/>


<p>A <span class="italic">differential equation</span> is an equation involving an unknown 
<span class="italic">function</span> and one or more of its derivatives.  
<span class="index">differential equation</span><a name="chapter-8-153"/> The equation is called <span class="italic">ordinary</span> 
if derivatives with respect to <span class="index">equation:differential</span><a name="chapter-8-154"/> only 
one dependent variable appear in the equation (it is called 
<span class="italic">partial</span> otherwise).  The package <span class="teletype">ElementaryFunctionODESolver</span> 
provides the top-level operation <span style="font-weight: bold;"> solve</span> for finding closed-form 
solutions of ordinary differential equations.  
<span class="index">ElementaryFunctionODESolver</span><a name="chapter-8-155"/>
</p>


<p>To solve a differential equation, you must first create an operator
for <span class="index">operator</span><a name="chapter-8-156"/> the unknown function.
</p>


<p>We let  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math> be the unknown function in terms of  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>x</mi></mstyle></math>.
</p>




<div id="spadComm8-190" class="spadComm" >
<form id="formComm8-190" action="javascript:makeRequest('8-190');" >
<input id="comm8-190" type="text" class="command" style="width: 12em;" value="y := operator 'y " />
</form>
<span id="commSav8-190" class="commSav" >y := operator 'y </span>
<div id="mathAns8-190" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>y</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>



<p>You then type the equation using <span class="teletype">D</span> to create the
derivatives of the unknown function  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mstyle></math> where  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>x</mi></mstyle></math> is any
symbol you choose (the so-called <span class="italic">dependent variable</span>).
</p>


<p>This is how you enter
the equation  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>+</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>+</mo><mi>y</mi><mo>=</mo><mn>0</mn></mrow></mstyle></math>.
</p>




<div id="spadComm8-191" class="spadComm" >
<form id="formComm8-191" action="javascript:makeRequest('8-191');" >
<input id="comm8-191" type="text" class="command" style="width: 28em;" value="deq := D(y x, x, 2) + D(y x, x) + y x = 0" />
</form>
<span id="commSav8-191" class="commSav" >deq := D(y x, x, 2) + D(y x, x) + y x = 0</span>
<div id="mathAns8-191" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>+</mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>+</mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>



<p>The simplest way to invoke the <span style="font-weight: bold;"> solve</span> command is with three
arguments.
</p>



<ul>
<li>
 the differential equation,
</li>
<li> the operator representing the unknown function,
</li>
<li> the dependent variable.
</li>
</ul>



<p>So, to solve the above equation, we enter this.
</p>




<div id="spadComm8-192" class="spadComm" >
<form id="formComm8-192" action="javascript:makeRequest('8-192');" >
<input id="comm8-192" type="text" class="command" style="width: 12em;" value="solve(deq, y, x) " />
</form>
<span id="commSav8-192" class="commSav" >solve(deq, y, x) </span>
<div id="mathAns8-192" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mrow><mrow><mo>cos</mo><mo>(</mo><mfrac><mrow><mi>x</mi><mo></mo><mrow><msqrt><mn>3</mn></msqrt></mrow></mrow><mn>2</mn></mfrac><mo>)</mo></mrow><mo></mo><mrow><msup><mi>e</mi><mrow><mo>(</mo><mo>-</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>)</mo></mrow></msup></mrow></mrow><mo>,</mo><mrow><mrow><msup><mi>e</mi><mrow><mo>(</mo><mo>-</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>)</mo></mrow></msup></mrow><mo></mo><mrow><mo>sin</mo><mo>(</mo><mfrac><mrow><mi>x</mi><mo></mo><mrow><msqrt><mn>3</mn></msqrt></mrow></mrow><mn>2</mn></mfrac><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>



<p>Since linear ordinary differential equations have infinitely many
solutions, <span style="font-weight: bold;"> solve</span> returns a <span class="italic">particular solution</span>  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><msub><mi>f</mi><mi>p</mi></msub></mrow></mstyle></math> and a
basis  <math xmlns="&mathml;" mathsize="big"><mstyle></mstyle></math> for the solutions of the corresponding
homogenuous equation.  Any expression of the form 
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle></mstyle></math> 
where the  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow></mstyle></math> do not involve the dependent variable
is also a solution.  This is similar to what you get when you solve
systems of linear algebraic equations.
</p>


<p>A way to select a unique solution is to specify <span class="italic">initial
conditions</span>: choose a value  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>a</mi></mstyle></math> for the dependent variable and specify
the values of the unknown function and its derivatives at  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>a</mi></mstyle></math>.  If the
number of initial conditions is equal to the order of the equation,
then the solution is unique (if it exists in closed form!) and <span style="font-weight: bold;">
solve</span> tries to find it.  To specify initial conditions to <span style="font-weight: bold;">
solve</span>, use an <span class="teletype">Equation</span> of the form  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>x</mi><mo>=</mo><mi>a</mi></mrow></mstyle></math> for the third
parameter instead of the dependent variable, and add a fourth
parameter consisting of the list of values  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>y</mi><mo>(</mo><mi>a</mi><mo>)</mo><mo>,</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>(</mo><mi>a</mi><mo>)</mo><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo></mrow></mstyle></math>.
</p>


<p>To find the solution of  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>+</mo><mi>y</mi><mo>=</mo><mn>0</mn></mrow></mstyle></math> satisfying  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>y</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></math>,
do this.
</p>




<div id="spadComm8-193" class="spadComm" >
<form id="formComm8-193" action="javascript:makeRequest('8-193');" >
<input id="comm8-193" type="text" class="command" style="width: 18em;" value="deq := D(y x, x, 2) + y x " />
</form>
<span id="commSav8-193" class="commSav" >deq := D(y x, x, 2) + y x </span>
<div id="mathAns8-193" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>+</mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>You can omit the  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mo>=</mo><mn>0</mn></mrow></mstyle></math> when you enter the equation to be solved.
</p>




<div id="spadComm8-194" class="spadComm" >
<form id="formComm8-194" action="javascript:makeRequest('8-194');" >
<input id="comm8-194" type="text" class="command" style="width: 20em;" value="solve(deq, y, x = 0, [1, 1]) " />
</form>
<span id="commSav8-194" class="commSav" >solve(deq, y, x = 0, [1, 1]) </span>
<div id="mathAns8-194" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mo>sin</mo><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>+</mo><mrow><mo>cos</mo><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Expression Integer,...)
</div>



<p>Axiom is not limited to linear differential equations with constant
coefficients.  It can also find solutions when the coefficients are
rational or algebraic functions of the dependent variable.
Furthermore, Axiom is not limited by the order of the equation.
</p>


<p>Axiom can solve the following third order equations with
polynomial coefficients.
</p>




<div id="spadComm8-195" class="spadComm" >
<form id="formComm8-195" action="javascript:makeRequest('8-195');" >
<input id="comm8-195" type="text" class="command" style="width: 60em;" value="deq := x**3 * D(y x, x, 3) + x**2 * D(y x, x, 2) - 2 * x * D(y x, x) + 2 * y x = 2 * x**4 " />
</form>
<span id="commSav8-195" class="commSav" >deq := x**3 * D(y x, x, 3) + x**2 * D(y x, x, 2) - 2 * x * D(y x, x) + 2 * y x = 2 * x**4 </span>
<div id="mathAns8-195" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mi>x</mi><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo></mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mn>2</mn><mo></mo><mrow><msup><mi>x</mi><mn>4</mn></msup></mrow></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>





<div id="spadComm8-196" class="spadComm" >
<form id="formComm8-196" action="javascript:makeRequest('8-196');" >
<input id="comm8-196" type="text" class="command" style="width: 12em;" value="solve(deq, y, x) " />
</form>
<span id="commSav8-196" class="commSav" >solve(deq, y, x) </span>
<div id="mathAns8-196" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mtable><mtr><mtd><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mfrac><mrow><mrow><msup><mi>x</mi><mn>5</mn></msup></mrow><mo>-</mo><mrow><mn>10</mn><mo></mo><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>20</mn><mo></mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow><mo>+</mo><mn>4</mn></mrow><mrow><mn>15</mn><mo></mo><mi>x</mi></mrow></mfrac></mrow></mrow><mo>,</mo></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd><mrow><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mfrac><mrow><mrow><mn>2</mn><mo></mo><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>3</mn><mo></mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mi>x</mi></mfrac><mo>,</mo><mfrac><mrow><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>-</mo><mn>1</mn></mrow><mi>x</mi></mfrac><mo>,</mo><mfrac><mrow><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>-</mo><mrow><mn>3</mn><mo></mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow><mo>-</mo><mn>1</mn></mrow><mi>x</mi></mfrac><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mtd></mtr></mtable></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>



<p>Here we are solving a homogeneous equation.
</p>




<div id="spadComm8-197" class="spadComm" >
<form id="formComm8-197" action="javascript:makeRequest('8-197');" >
<input id="comm8-197" type="text" class="command" style="width: 74em;" value="deq := (x**9+x**3) * D(y x, x, 3) + 18 * x**8 * D(y x, x, 2) - 90 * x * D(y x, x) - 30 * (11 * x**6 - 3) * y x " />
</form>
<span id="commSav8-197" class="commSav" >deq := (x**9+x**3) * D(y x, x, 3) + 18 * x**8 * D(y x, x, 2) - 90 * x * D(y x, x) - 30 * (11 * x**6 - 3) * y x </span>
<div id="mathAns8-197" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mo>(</mo><mrow><msup><mi>x</mi><mn>9</mn></msup></mrow><mo>+</mo><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow><mo>)</mo></mrow><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mn>18</mn><mo></mo><mrow><msup><mi>x</mi><mn>8</mn></msup></mrow><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>-</mo><mrow><mn>90</mn><mo></mo><mi>x</mi><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mrow><mo>(</mo><mo>-</mo><mrow><mn>330</mn><mo></mo><mrow><msup><mi>x</mi><mn>6</mn></msup></mrow></mrow><mo>+</mo><mn>90</mn><mo>)</mo></mrow><mo></mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>





<div id="spadComm8-198" class="spadComm" >
<form id="formComm8-198" action="javascript:makeRequest('8-198');" >
<input id="comm8-198" type="text" class="command" style="width: 12em;" value="solve(deq, y, x) " />
</form>
<span id="commSav8-198" class="commSav" >solve(deq, y, x) </span>
<div id="mathAns8-198" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mfrac><mi>x</mi><mrow><mrow><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>,</mo><mfrac><mrow><mi>x</mi><mo></mo><mrow><msup><mi>e</mi><mrow><mo>(</mo><mo>-</mo><mrow><mrow><msqrt><mn>91</mn></msqrt></mrow><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>)</mo></mrow></msup></mrow></mrow><mrow><mrow><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>,</mo><mfrac><mrow><mi>x</mi><mo></mo><mrow><msup><mi>e</mi><mrow><mo>(</mo><mrow><msqrt><mn>91</mn></msqrt></mrow><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>)</mo></mrow></msup></mrow></mrow><mrow><mrow><msup><mi>x</mi><mn>6</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></mfrac><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>



<p>On the other hand, and in contrast with the operation <span style="font-weight: bold;"> integrate</span>,
it can happen that Axiom finds no solution and that some closed-form
solution still exists.  While it is mathematically complicated to
describe exactly when the solutions are guaranteed to be found, the
following statements are correct and form good guidelines for linear
ordinary differential equations:
</p>



<ul>
<li>
 If the coefficients are constants, Axiom finds a complete basis
of solutions (i,e, all solutions).
</li>
<li> If the coefficients are rational functions in the dependent variable,
Axiom at least finds all solutions that do not involve algebraic
functions.
</li>
</ul>



<p>Note that this last statement does not mean that Axiom does not find
the solutions that are algebraic functions.  It means that it is not
guaranteed that the algebraic function solutions will be found.
</p>


<p>This is an example where all the algebraic solutions are found.
</p>




<div id="spadComm8-199" class="spadComm" >
<form id="formComm8-199" action="javascript:makeRequest('8-199');" >
<input id="comm8-199" type="text" class="command" style="width: 42em;" value="deq := (x**2 + 1) * D(y x, x, 2) + 3 * x * D(y x, x) + y x = 0 " />
</form>
<span id="commSav8-199" class="commSav" >deq := (x**2 + 1) * D(y x, x, 2) + 3 * x * D(y x, x) + y x = 0 </span>
<div id="mathAns8-199" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mrow><mo>(</mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mn>1</mn><mo>)</mo></mrow><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mn>3</mn><mo></mo><mi>x</mi><mo></mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>





<div id="spadComm8-200" class="spadComm" >
<form id="formComm8-200" action="javascript:makeRequest('8-200');" >
<input id="comm8-200" type="text" class="command" style="width: 12em;" value="solve(deq, y, x) " />
</form>
<span id="commSav8-200" class="commSav" >solve(deq, y, x) </span>
<div id="mathAns8-200" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></msqrt></mrow></mfrac><mo>,</mo><mfrac><mrow><mo>log</mo><mo>(</mo><mrow><mrow><msqrt><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></msqrt></mrow><mo>-</mo><mi>x</mi></mrow><mo>)</mo></mrow><mrow><msqrt><mrow><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></msqrt></mrow></mfrac><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>





</div>



<a name="subsec-8.10.2"/>
<div class="subsection"  id="subsec-8.10.2">
<h3 class="subsectitle">8.10.2  Closed-Form Solutions of Non-Linear Differential Equations</h3>


<a name="ugxProblemNLDEQClosed" class="label"/>


<p>This is an example that shows how to solve a non-linear first order
ordinary differential equation manually when an integrating factor can
be found just by integration.  At the end, we show you how to solve it
directly.
</p>


<p>Let's solve the differential equation  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><msup><mi>y</mi><mo>&prime;</mo></msup><mo>=</mo><mi>y</mi><mo>/</mo><mo>(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mi>log</mi><mi>y</mi><mo>)</mo></mrow></mstyle></math>.
</p>


<p>Using the notation  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>m</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo><mo>+</mo><mi>n</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>=</mo><mn>0</mn></mrow></mstyle></math>, we have  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>m</mi><mo>=</mo><mo>-</mo><mi>y</mi></mrow></mstyle></math> and 
 <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>n</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi><mi>log</mi><mi>y</mi></mrow></mstyle></math>.
</p>




<div id="spadComm8-201" class="spadComm" >
<form id="formComm8-201" action="javascript:makeRequest('8-201');" >
<input id="comm8-201" type="text" class="command" style="width: 6em;" value="m := -y " />
</form>
<span id="commSav8-201" class="commSav" >m := -y </span>
<div id="mathAns8-201" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mi>y</mi></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Polynomial Integer
</div>





<div id="spadComm8-202" class="spadComm" >
<form id="formComm8-202" action="javascript:makeRequest('8-202');" >
<input id="comm8-202" type="text" class="command" style="width: 13em;" value="n := x + y * log y " />
</form>
<span id="commSav8-202" class="commSav" >n := x + y * log y </span>
<div id="mathAns8-202" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mi>y</mi><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>+</mo><mi>x</mi></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>We first check for exactness, that is, does  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>dm</mi><mo>/</mo><mi>dy</mi><mo>=</mo><mi>dn</mi><mo>/</mo><mi>dx</mi></mrow></mstyle></math>?
</p>




<div id="spadComm8-203" class="spadComm" >
<form id="formComm8-203" action="javascript:makeRequest('8-203');" >
<input id="comm8-203" type="text" class="command" style="width: 12em;" value="D(m, y) - D(n, x) " />
</form>
<span id="commSav8-203" class="commSav" >D(m, y) - D(n, x) </span>
<div id="mathAns8-203" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mn>2</mn></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>This is not zero, so the equation is not exact.  Therefore we must
look for an integrating factor: a function  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>mu</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> such that 
 <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>d</mi><mo>(</mo><mi>mu</mi><mi>m</mi><mo>)</mo><mo>/</mo><mi>dy</mi><mo>=</mo><mi>d</mi><mo>(</mo><mi>mu</mi><mi>n</mi><mo>)</mo><mo>/</mo><mi>dx</mi></mrow></mstyle></math>.  Normally, we first search for  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>mu</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math>
depending only on  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>x</mi></mstyle></math> or only on  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math>.
</p>


<p>Let's search for such a  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>mu</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mstyle></math> first.
</p>




<div id="spadComm8-204" class="spadComm" >
<form id="formComm8-204" action="javascript:makeRequest('8-204');" >
<input id="comm8-204" type="text" class="command" style="width: 13em;" value="mu := operator 'mu " />
</form>
<span id="commSav8-204" class="commSav" >mu := operator 'mu </span>
<div id="mathAns8-204" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>mu</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>





<div id="spadComm8-205" class="spadComm" >
<form id="formComm8-205" action="javascript:makeRequest('8-205');" >
<input id="comm8-205" type="text" class="command" style="width: 26em;" value="a := D(mu(x) * m, y) - D(mu(x) * n, x) " />
</form>
<span id="commSav8-205" class="commSav" >a := D(mu(x) * m, y) - D(mu(x) * n, x) </span>
<div id="mathAns8-205" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mo>(</mo><mo>-</mo><mrow><mi>y</mi><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>-</mo><mi>x</mi><mo>)</mo></mrow><mo></mo><mrow><mrow><msubsup><mi>mu</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mrow><mi>mu</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>If the above is zero for a function  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>mu</mi></mstyle></math> that does <span class="italic">not</span> depend on
 <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math>, then  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>mu</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mstyle></math> is an integrating factor.
</p>




<div id="spadComm8-206" class="spadComm" >
<form id="formComm8-206" action="javascript:makeRequest('8-206');" >
<input id="comm8-206" type="text" class="command" style="width: 14em;" value="solve(a = 0, mu, x) " />
</form>
<span id="commSav8-206" class="commSav" >solve(a = 0, mu, x) </span>
<div id="mathAns8-206" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mfrac><mn>1</mn><mrow><mrow><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow><mo></mo><mrow><msup><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>2</mn><mo></mo><mi>x</mi><mo></mo><mi>y</mi><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>+</mo><mrow><msup><mi>x</mi><mn>2</mn></msup></mrow></mrow></mfrac><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>



<p>The solution depends on  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math>, so there is no integrating factor that
depends on  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>x</mi></mstyle></math> only.
</p>


<p>Let's look for one that depends on  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math> only.
</p>




<div id="spadComm8-207" class="spadComm" >
<form id="formComm8-207" action="javascript:makeRequest('8-207');" >
<input id="comm8-207" type="text" class="command" style="width: 26em;" value="b := D(mu(y) * m, y) - D(mu(y) * n, x) " />
</form>
<span id="commSav8-207" class="commSav" >b := D(mu(y) * m, y) - D(mu(y) * n, x) </span>
<div id="mathAns8-207" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mrow><mi>y</mi><mo></mo><mrow><mrow><msubsup><mi>mu</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mrow><mi>mu</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>





<div id="spadComm8-208" class="spadComm" >
<form id="formComm8-208" action="javascript:makeRequest('8-208');" >
<input id="comm8-208" type="text" class="command" style="width: 18em;" value="sb := solve(b = 0, mu, y) " />
</form>
<span id="commSav8-208" class="commSav" >sb := solve(b = 0, mu, y) </span>
<div id="mathAns8-208" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mn>0</mn></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mfrac><mn>1</mn><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: List Expression Integer),...)
</div>




<p>We've found one!
</p>


<p>The above  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>mu</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> is an integrating factor.  We must multiply our
initial equation (that is,  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>m</mi></mstyle></math> and  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>n</mi></mstyle></math>) by the integrating factor.
</p>




<div id="spadComm8-209" class="spadComm" >
<form id="formComm8-209" action="javascript:makeRequest('8-209');" >
<input id="comm8-209" type="text" class="command" style="width: 16em;" value="intFactor := sb.basis.1 " />
</form>
<span id="commSav8-209" class="commSav" >intFactor := sb.basis.1 </span>
<div id="mathAns8-209" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mn>1</mn><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>





<div id="spadComm8-210" class="spadComm" >
<form id="formComm8-210" action="javascript:makeRequest('8-210');" >
<input id="comm8-210" type="text" class="command" style="width: 13em;" value="m := intFactor * m " />
</form>
<span id="commSav8-210" class="commSav" >m := intFactor * m </span>
<div id="mathAns8-210" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>-</mo><mfrac><mn>1</mn><mi>y</mi></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>





<div id="spadComm8-211" class="spadComm" >
<form id="formComm8-211" action="javascript:makeRequest('8-211');" >
<input id="comm8-211" type="text" class="command" style="width: 13em;" value="n := intFactor * n " />
</form>
<span id="commSav8-211" class="commSav" >n := intFactor * n </span>
<div id="mathAns8-211" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mrow><mrow><mi>y</mi><mo></mo><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>+</mo><mi>x</mi></mrow><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>Let's check for exactness.
</p>




<div id="spadComm8-212" class="spadComm" >
<form id="formComm8-212" action="javascript:makeRequest('8-212');" >
<input id="comm8-212" type="text" class="command" style="width: 12em;" value="D(m, y) - D(n, x) " />
</form>
<span id="commSav8-212" class="commSav" >D(m, y) - D(n, x) </span>
<div id="mathAns8-212" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mn>0</mn></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>We must solve the exact equation, that is, find a function  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>s</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math>
such that  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>ds</mi><mo>/</mo><mi>dx</mi><mo>=</mo><mi>m</mi></mrow></mstyle></math> and  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>ds</mi><mo>/</mo><mi>dy</mi><mo>=</mo><mi>n</mi></mrow></mstyle></math>.
</p>


<p>We start by writing  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>s</mi><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>)</mo><mo>=</mo><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo><mo>+</mo><mi>integrate</mi><mo>(</mo><mi>m</mi><mo>,</mo><mi>x</mi><mo>)</mo></mrow></mstyle></math> where  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> is
an unknown function of  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math>.  This guarantees that  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>ds</mi><mo>/</mo><mi>dx</mi><mo>=</mo><mi>m</mi></mrow></mstyle></math>.
</p>




<div id="spadComm8-213" class="spadComm" >
<form id="formComm8-213" action="javascript:makeRequest('8-213');" >
<input id="comm8-213" type="text" class="command" style="width: 12em;" value="h := operator 'h " />
</form>
<span id="commSav8-213" class="commSav" >h := operator 'h </span>
<div id="mathAns8-213" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>h</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>





<div id="spadComm8-214" class="spadComm" >
<form id="formComm8-214" action="javascript:makeRequest('8-214');" >
<input id="comm8-214" type="text" class="command" style="width: 20em;" value="sol := h y + integrate(m, x) " />
</form>
<span id="commSav8-214" class="commSav" >sol := h y + integrate(m, x) </span>
<div id="mathAns8-214" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mrow><mrow><mi>y</mi><mo></mo><mrow><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>-</mo><mi>x</mi></mrow><mi>y</mi></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>All we want is to find  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> such that  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>ds</mi><mo>/</mo><mi>dy</mi><mo>=</mo><mi>n</mi></mrow></mstyle></math>.
</p>




<div id="spadComm8-215" class="spadComm" >
<form id="formComm8-215" action="javascript:makeRequest('8-215');" >
<input id="comm8-215" type="text" class="command" style="width: 12em;" value="dsol := D(sol, y) " />
</form>
<span id="commSav8-215" class="commSav" >dsol := D(sol, y) </span>
<div id="mathAns8-215" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mrow><mrow><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow><mo></mo><mrow><mrow><msubsup><mi>h</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mrow><mo>+</mo><mi>x</mi></mrow><mrow><msup><mi>y</mi><mn>2</mn></msup></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>





<div id="spadComm8-216" class="spadComm" >
<form id="formComm8-216" action="javascript:makeRequest('8-216');" >
<input id="comm8-216" type="text" class="command" style="width: 20em;" value="nsol := solve(dsol = n, h, y) " />
</form>
<span id="commSav8-216" class="commSav" >nsol := solve(dsol = n, h, y) </span>
<div id="mathAns8-216" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>particular</mi><mo>=</mo><mfrac><mrow><msup><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow><mn>2</mn></msup></mrow><mn>2</mn></mfrac></mrow><mo>,</mo><mrow><mi>basis</mi><mo>=</mo><mrow><mo>[</mo><mn>1</mn><mo>]</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Record(particular: Expression Integer,basis: 
List Expression Integer),...)
</div>



<p>The above particular solution is the  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> we want, so we just replace
 <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>h</mi><mo>(</mo><mi>y</mi><mo>)</mo></mrow></mstyle></math> by it in the implicit solution.
</p>




<div id="spadComm8-217" class="spadComm" >
<form id="formComm8-217" action="javascript:makeRequest('8-217');" >
<input id="comm8-217" type="text" class="command" style="width: 22em;" value="eval(sol, h y = nsol.particular) " />
</form>
<span id="commSav8-217" class="commSav" >eval(sol, h y = nsol.particular) </span>
<div id="mathAns8-217" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mrow><mrow><mi>y</mi><mo></mo><mrow><msup><mrow><mo>log</mo><mo>(</mo><mi>y</mi><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mi>x</mi></mrow></mrow><mrow><mn>2</mn><mo></mo><mi>y</mi></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Expression Integer
</div>



<p>A first integral of the initial equation is obtained by setting this
result equal to an arbitrary constant.
</p>


<p>Now that we've seen how to solve the equation ``by hand,'' we show you
how to do it with the <span style="font-weight: bold;"> solve</span> operation.
</p>


<p>First define  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math> to be an operator.
</p>




<div id="spadComm8-218" class="spadComm" >
<form id="formComm8-218" action="javascript:makeRequest('8-218');" >
<input id="comm8-218" type="text" class="command" style="width: 12em;" value="y := operator 'y " />
</form>
<span id="commSav8-218" class="commSav" >y := operator 'y </span>
<div id="mathAns8-218" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>y</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>



<p>Next we create the differential equation.
</p>




<div id="spadComm8-219" class="spadComm" >
<form id="formComm8-219" action="javascript:makeRequest('8-219');" >
<input id="comm8-219" type="text" class="command" style="width: 32em;" value="deq := D(y x, x) = y(x) / (x + y(x) * log y x) " />
</form>
<span id="commSav8-219" class="commSav" >deq := D(y x, x) = y(x) / (x + y(x) * log y x) </span>
<div id="mathAns8-219" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mrow><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo></mo><mrow><mo>log</mo><mo>(</mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mi>x</mi></mrow></mfrac></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>



<p>Finally, we solve it.
</p>




<div id="spadComm8-220" class="spadComm" >
<form id="formComm8-220" action="javascript:makeRequest('8-220');" >
<input id="comm8-220" type="text" class="command" style="width: 12em;" value="solve(deq, y, x) " />
</form>
<span id="commSav8-220" class="commSav" >solve(deq, y, x) </span>
<div id="mathAns8-220" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mfrac><mrow><mrow><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo></mo><mrow><msup><mrow><mo>log</mo><mo>(</mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></mrow></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mi>x</mi></mrow></mrow><mrow><mn>2</mn><mo></mo><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mfrac></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Union(Expression Integer,...)
</div>





</div>



<a name="subsec-8.10.3"/>
<div class="subsection"  id="subsec-8.10.3">
<h3 class="subsectitle">8.10.3  Power Series Solutions of Differential Equations</h3>


<a name="ugxProblemDEQSeries" class="label"/>


<p>The command to solve differential equations in power
<span class="index">equation:differential:solving in power series</span><a name="chapter-8-157"/> series
<span class="index">power series</span><a name="chapter-8-158"/> around <span class="index">series:power</span><a name="chapter-8-159"/> a particular initial
point with specific initial conditions is called <span style="font-weight: bold;"> seriesSolve</span>.
It can take a variety of parameters, so we illustrate its use with
some examples.
</p>


<p>Since the coefficients of some solutions are quite large, we reset the
default to compute only seven terms.
</p>




<div id="spadComm8-221" class="spadComm" >
<form id="formComm8-221" action="javascript:makeRequest('8-221');" >
<input id="comm8-221" type="text" class="command" style="width: 17em;" value=")set streams calculate 7 " />
</form>
<span id="commSav8-221" class="commSav" >)set streams calculate 7 </span>
<div id="mathAns8-221" ></div>
</div>



<p>You can solve a single nonlinear equation of any order. For example,
we solve 
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>=</mo><mi>sin</mi><mo>(</mo><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>)</mo><mo>*</mo><mi>exp</mi><mo>(</mo><mi>y</mi><mo>)</mo><mo>+</mo><mi>cos</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mstyle></math> subject to 
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mi>y</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn><mo>,</mo><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mstyle></math>
</p>


<p>We first tell Axiom that the symbol  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mtext mathvariant="monospace">'</mtext><mi>y</mi></mrow></mstyle></math> denotes a new operator.
</p>




<div id="spadComm8-222" class="spadComm" >
<form id="formComm8-222" action="javascript:makeRequest('8-222');" >
<input id="comm8-222" type="text" class="command" style="width: 12em;" value="y := operator 'y " />
</form>
<span id="commSav8-222" class="commSav" >y := operator 'y </span>
<div id="mathAns8-222" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>y</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>



<p>Enter the differential equation using  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>y</mi></mstyle></math> like any system function.
</p>




<div id="spadComm8-223" class="spadComm" >
<form id="formComm8-223" action="javascript:makeRequest('8-223');" >
<input id="comm8-223" type="text" class="command" style="width: 40em;" value="eq := D(y(x), x, 3) - sin(D(y(x), x, 2))*exp(y(x)) = cos(x)" />
</form>
<span id="commSav8-223" class="commSav" >eq := D(y(x), x, 3) - sin(D(y(x), x, 2))*exp(y(x)) = cos(x)</span>
<div id="mathAns8-223" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>-</mo><mrow><mrow><msup><mi>e</mi><mrow><mi>y</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></msup></mrow><mo></mo><mrow><mo>sin</mo><mo>(</mo><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></mrow></msubsup></mrow><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mo>)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mo>cos</mo><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>



<p>Solve it around  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow></mstyle></math> with the initial conditions
 <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>y</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>1</mn><mo>,</mo><msup><mi>y</mi><mo>&prime;</mo></msup><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><msup><mi>y</mi><mrow><mo>&prime;</mo><mo>&prime;</mo></mrow></msup><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mstyle></math>.
</p>




<div id="spadComm8-224" class="spadComm" >
<form id="formComm8-224" action="javascript:makeRequest('8-224');" >
<input id="comm8-224" type="text" class="command" style="width: 24em;" value="seriesSolve(eq, y, x = 0, [1, 0, 0])" />
</form>
<span id="commSav8-224" class="commSav" >seriesSolve(eq, y, x = 0, [1, 0, 0])</span>
<div id="mathAns8-224" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mn>1</mn><mo>+</mo><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac><mo></mo><mrow><msup><mi>x</mi><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mi>e</mi><mn>24</mn></mfrac><mo></mo><mrow><msup><mi>x</mi><mn>4</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mrow><msup><mi>e</mi><mn>2</mn></msup></mrow><mo>-</mo><mn>1</mn></mrow><mn>120</mn></mfrac><mo></mo><mrow><msup><mi>x</mi><mn>5</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mrow><msup><mi>e</mi><mn>3</mn></msup></mrow><mo>-</mo><mrow><mn>2</mn><mo></mo><mi>e</mi></mrow></mrow><mn>720</mn></mfrac><mo></mo><mrow><msup><mi>x</mi><mn>6</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mrow><msup><mi>e</mi><mn>4</mn></msup></mrow><mo>-</mo><mrow><mn>8</mn><mo></mo><mrow><msup><mi>e</mi><mn>2</mn></msup></mrow></mrow><mo>+</mo><mrow><mn>4</mn><mo></mo><mi>e</mi></mrow><mo>+</mo><mn>1</mn></mrow><mn>5040</mn></mfrac><mo></mo><mrow><msup><mi>x</mi><mn>7</mn></msup></mrow></mrow><mo>+</mo><mrow><mi>O</mi><mo>(</mo><mrow><msup><mi>x</mi><mn>8</mn></msup></mrow><mo>)</mo></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: UnivariateTaylorSeries(Expression Integer,x,0)
</div>



<p>You can also solve a system of nonlinear first order equations.  For
example, we solve a system that has  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>tan</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mstyle></math> and  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>sec</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mstyle></math> as
solutions.
</p>


<p>We tell Axiom that  <math xmlns="&mathml;" mathsize="big"><mstyle><mi>x</mi></mstyle></math> is also an operator.
</p>




<div id="spadComm8-225" class="spadComm" >
<form id="formComm8-225" action="javascript:makeRequest('8-225');" >
<input id="comm8-225" type="text" class="command" style="width: 11em;" value="x := operator 'x" />
</form>
<span id="commSav8-225" class="commSav" >x := operator 'x</span>
<div id="mathAns8-225" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mi>x</mi></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: BasicOperator
</div>



<p>Enter the two equations forming our system.
</p>




<div id="spadComm8-226" class="spadComm" >
<form id="formComm8-226" action="javascript:makeRequest('8-226');" >
<input id="comm8-226" type="text" class="command" style="width: 21em;" value="eq1 := D(x(t), t) = 1 + x(t)**2" />
</form>
<span id="commSav8-226" class="commSav" >eq1 := D(x(t), t) = 1 + x(t)**2</span>
<div id="mathAns8-226" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><msubsup><mi>x</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mrow><mrow><msup><mrow><mi>x</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mn>2</mn></msup></mrow><mo>+</mo><mn>1</mn></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>





<div id="spadComm8-227" class="spadComm" >
<form id="formComm8-227" action="javascript:makeRequest('8-227');" >
<input id="comm8-227" type="text" class="command" style="width: 21em;" value="eq2 := D(y(t), t) = x(t) * y(t)" />
</form>
<span id="commSav8-227" class="commSav" >eq2 := D(y(t), t) = x(t) * y(t)</span>
<div id="mathAns8-227" ></div>
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mrow><mrow><msubsup><mi>y</mi><mrow><mo></mo></mrow><mrow><mo>&prime;</mo></mrow></msubsup></mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo>=</mo><mrow><mrow><mi>x</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow><mo></mo><mrow><mi>y</mi><mo>(</mo><mi>t</mi><mo>)</mo></mrow></mrow></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: Equation Expression Integer
</div>



<p>Solve the system around  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow></mstyle></math> with the initial conditions  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>x</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mstyle></math>
and  <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mi>y</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></math>.  Notice that since we give the unknowns in the order
 <math xmlns="&mathml;" mathsize="big"><mstyle><mrow><mo>[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>]</mo></mrow></mstyle></math>, the answer is a list of two series in the order 
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mtext>series&nbsp;for&nbsp;</mtext></mrow><mi>x</mi><mo>(</mo><mi>t</mi><mo>)</mo><mo>,</mo><mrow><mtext>&nbsp;series&nbsp;for&nbsp;</mtext></mrow><mi>y</mi><mo>(</mo><mi>t</mi><mo>)</mo><mo>]</mo></mrow></mstyle></math>
</p>




<div id="spadComm8-228" class="spadComm" >
<form id="formComm8-228" action="javascript:makeRequest('8-228');" >
<input id="comm8-228" type="text" class="command" style="width: 40em;" value="seriesSolve([eq2, eq1], [x, y], t = 0, [y(0) = 1, x(0) = 0])" />
</form>
<span id="commSav8-228" class="commSav" >seriesSolve([eq2, eq1], [x, y], t = 0, [y(0) = 1, x(0) = 0])</span>
<div id="mathAns8-228" ></div>
</div>




<div class="verbatim"><br />
&nbsp;&nbsp;&nbsp;Compiling&nbsp;function&nbsp;%BZ&nbsp;with&nbsp;type&nbsp;List&nbsp;UnivariateTaylorSeries(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expression&nbsp;Integer,t,0)&nbsp;-&gt;&nbsp;UnivariateTaylorSeries(Expression&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer,t,0)&nbsp;<br />
&nbsp;&nbsp;&nbsp;Compiling&nbsp;function&nbsp;%CA&nbsp;with&nbsp;type&nbsp;List&nbsp;UnivariateTaylorSeries(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Expression&nbsp;Integer,t,0)&nbsp;-&gt;&nbsp;UnivariateTaylorSeries(Expression&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Integer,t,0)&nbsp;<br />
</div>


<div class="math">
<table>
<tr><td>
<math xmlns="&mathml;" mathsize="big" display="block"><mstyle><mrow><mo>[</mo><mrow><mi>t</mi><mo>+</mo><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>3</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>2</mn><mn>15</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>5</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>17</mn><mn>315</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>7</mn></msup></mrow></mrow><mo>+</mo><mrow><mi>O</mi><mo>(</mo><mrow><msup><mi>t</mi><mn>8</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>,</mo><mrow><mn>1</mn><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>2</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>5</mn><mn>24</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>4</mn></msup></mrow></mrow><mo>+</mo><mrow><mfrac><mn>61</mn><mn>720</mn></mfrac><mo></mo><mrow><msup><mi>t</mi><mn>6</mn></msup></mrow></mrow><mo>+</mo><mrow><mi>O</mi><mo>(</mo><mrow><msup><mi>t</mi><mn>8</mn></msup></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mstyle></math>
</td></tr>
</table>
</div>




<div class="returnType">
Type: List UnivariateTaylorSeries(Expression Integer,t,0)
</div>




<p>The order in which we give the equations and the initial conditions
has no effect on the order of the solution.
</p>




</div>




</div><a href="book-contents.xhtml" style="margin-right: 10px;">Book Contents</a>
<a href="section-8.9.xhtml" style="margin-right: 10px;">Previous Section 8.9 Working with Power Series</a><a href="section-8.11.xhtml" style="margin-right: 10px;">Next Section 8.11 Finite Fields</a>
<a href="book-index.xhtml">Book Index</a></body>
</html>